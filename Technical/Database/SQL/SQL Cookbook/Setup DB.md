- Create example database
```sql
create database sql_cookbook

use sql_cookbook

create table emp (
    EMPNO INT NOT NULL PRIMARY KEY ,
    ENAME VARCHAR(MAX),
    JOB VARCHAR(MAX),
    MGR INT,
    HIREDATE DATE NOT NULL,
    SAL INT  NOT NULL,
    COM INT,
    DETNO INT
)

create table dept (
    DETNO INT NOT NULL PRIMARY KEY,
    DNAME VARCHAR(MAX),
    LOC VARCHAR(MAX)
)
ALTER TABLE emp ADD FOREIGN KEY (DETNO) REFERENCES dept(DETNO)
INSERT INTO dept VALUES(10, 'ACCOUNTING', 'NEW YORK'),
(20, 'RESEARCH', 'DALLAS'),
(30, 'SALES', 'CHICAGO'),
(40, 'OPERATIONS', 'BOSTON')
INSERT INTO emp VALUES  (7369, 'SMITH', 'CLERK', 7902, CONVERT(DATE, '17/11/2005', 103), 800,null,20),

 (7499, 'ALLEN', 'SALESMAN', 7698, CONVERT(DATE, '20/2/2006', 103), 1600, 300, 30),

 (7521, 'WARD', 'SALESMAN', 7698, CONVERT(DATE, '22/2/2006', 103), 1250, 500, 30),

 (7566, 'JONES', 'MANAGER', 7839, CONVERT(DATE, '02/4/2006', 103), 2975,null,20),

 (7654, 'MARTIN', 'SALESMAN', 7698, CONVERT(DATE, '28/9/2006', 103), 1250, 1400, 30),

 (7698, 'BLAKE', 'MANAGER', 7839, CONVERT(DATE, '01/5/2006', 103), 2850,null,30),

 (7782, 'CLARK', 'MANAGER', 7839, CONVERT(DATE, '09/6/2006', 103), 2450,null,10),

 (7788, 'SCOTT', 'ANALYST', 7566, CONVERT(DATE, '09/11/2007', 103), 3000,null,20),

 (7839, 'KING', 'PRESIDENT', null , CONVERT(DATE, '17/11/2006', 103), 5000,null,10),

 (7844, 'TURNER', 'SALESMAN', 7698, CONVERT(DATE, '08/9/2006', 103), 1500, 0, 30),

 (7876, 'ADAMS', 'CLERK', 7788, CONVERT(DATE, '12/1/2008', 103), 1100,null,20),

 (7900, 'JAMES', 'CLERK', 7698, CONVERT(DATE, '03/11/2006', 103), 950,null,30),

 (7902, 'FORD', 'ANALYST', 7566, CONVERT(DATE, '03/11/2006', 103), 3000,null,20),

 (7934, 'MILLER', 'CLERK', 7782, CONVERT(DATE, '23/1/2007', 103), 1300,null,10)
```

- Create pivot table
```sql
CREATE TABLE t1 (
   i INT,
   PRIMARY KEY(i)
)
CREATE TABLE Foo(
   i CHAR(1)
)
INSERT INTO Foo VALUES('0')
INSERT INTO Foo VALUES('1')
INSERT INTO Foo VALUES('2')
INSERT INTO Foo VALUES('3')
INSERT INTO Foo VALUES('4')
INSERT INTO Foo VALUES('5')
INSERT INTO Foo VALUES('6')
INSERT INTO Foo VALUES('7')
INSERT INTO Foo VALUES('8')
INSERT INTO Foo VALUES('9')
INSERT INTO t1

   SELECT f1.i

   FROM Foo f1
```